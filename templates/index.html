<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æˆ‘ãŒå®¶ã®ãƒªã‚¹ãƒˆ</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        body { font-family: sans-serif; padding: 20px; background-color: #f0f0f0; }
        h1 { font-size: 20px; color: #333; }
        .card { background: white; padding: 15px; margin-bottom: 10px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .type-badge { font-size: 12px; padding: 3px 8px; border-radius: 4px; color: white; display: inline-block; margin-bottom: 5px; }
        .bg-task { background-color: #ff9f43; } /* ã‚ªãƒ¬ãƒ³ã‚¸ */
        .bg-event { background-color: #54a0ff; } /* é’ */
        .summary { font-size: 18px; font-weight: bold; }
        .date { color: #888; font-size: 14px; margin-top: 5px; }
    </style>
</head>
<body>

    <h1>ğŸ“ å…±æœ‰ãƒªã‚¹ãƒˆ</h1>
    <div id="list-container">
        <p>èª­ã¿è¾¼ã¿ä¸­...</p>
    </div>

    <script>
        // ã“ã“ã«Renderã§è¨­å®šã—ãŸURLã¨ã‚­ãƒ¼ã‚’ç›´æ¥æ›¸ãå¿…è¦ãŒã‚ã‚‹ã®ã§ã™ãŒã€
        // ä»Šå›ã¯ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ã‚’å°‘ã—ç„¡è¦–ã—ã¦ã€HTMLã«åŸ‹ã‚è¾¼ã‚“ã˜ã‚ƒã„ã¾ã™ã€‚
        // ï¼ˆæœ¬æ¥ã¯ã‚µãƒ¼ãƒãƒ¼ã‹ã‚‰æ¸¡ã™ã®ãŒå®‰å…¨ã§ã™ãŒã€å’ç ”ãƒ‡ãƒ¢ç”¨ã¨ã—ã¦ç°¡æ˜“åŒ–ã—ã¾ã™ï¼‰
        
        // â˜…é‡è¦â˜… ã“ã“ã«è‡ªåˆ†ã®Supabaseã®æƒ…å ±ã‚’æ›¸ãè¾¼ã‚“ã§ãã ã•ã„ï¼
        const SUPABASE_URL = "https://ygnafllntoczlrkwluax.supabase.co";
        const SUPABASE_KEY = "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InlnbmFmbGxudG9jemxya3dsdWF4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NjQ1NjM3NDcsImV4cCI6MjA4MDEzOTc0N30.Ny_J6U3x23CPvJckmvUznK24lYOwq62fk17fZKm18cM";

        const supabase = supabase.createClient(SUPABASE_URL, SUPABASE_KEY);

        async function fetchTasks() {
            // tasksãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰å…¨ãƒ‡ãƒ¼ã‚¿ã‚’å–å¾—ï¼ˆæ–°ã—ã„é †ï¼‰
            const { data, error } = await supabase
                .from('tasks')
                .select('*')
                .order('created_at', { ascending: false });

            const container = document.getElementById('list-container');
            container.innerHTML = ""; // ã‚¯ãƒªã‚¢

            if (error) {
                container.innerHTML = "<p>ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸğŸ˜¢</p>";
                console.error(error);
                return;
            }

            if (data.length === 0) {
                container.innerHTML = "<p>ã¾ã ãƒªã‚¹ãƒˆã¯ã‚ã‚Šã¾ã›ã‚“âœ¨</p>";
                return;
            }

            // ãƒ‡ãƒ¼ã‚¿1ã¤ãšã¤ã‚«ãƒ¼ãƒ‰ã«ã—ã¦è¡¨ç¤º
            data.forEach(item => {
                const typeClass = item.type === 'task' ? 'bg-task' : 'bg-event';
                const typeName = item.type === 'task' ? 'è²·ã†/ã‚„ã‚‹' : 'äºˆå®š';
                
                const html = `
                    <div class="card">
                        <span class="type-badge ${typeClass}">${typeName}</span>
                        <div class="summary">${item.summary}</div>
                        <div class="date">${item.date || ""}</div>
                    </div>
                `;
                container.innerHTML += html;
            });
        }

        // ãƒšãƒ¼ã‚¸ãŒé–‹ã„ãŸã‚‰å®Ÿè¡Œ
        fetchTasks();
    </script>
</body>
</html>